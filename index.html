<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">

    <title></title>

    <script type="text/javascript" src="js/components/bindr.js"></script>
    <script type="text/javascript" src="js/components/commandr.js"></script>
    <script type="text/javascript" src="js/components/should.js"></script>
    <script type="text/javascript" src="js/app.js"></script>
    <script type="text/javascript" src="js/components/html.js"></script>
    <script type="text/javascript" src="js/calc.js"></script>
    <script type="text/javascript" src="js/expression.js"></script>
    <script type="text/javascript" src="js/formatter.js"></script>

    <script type="text/javascript" src="js/views.js"></script>
    <script type="text/javascript" src="js/expressionInputCtrl.js"></script>

    <link rel="stylesheet" type="text/css" href="css/styles.css" />
</head>
<body>
<input id="in" type="text"/>
<div id="out" type="text"></div>

<div id="output">

</div>

<script type="text/javascript">

    (function(){
        var app = window.app;
        var bindr = window.bindr;
        var expression = app.service('expression');
        var expressionInputCtrl = app.controller('expressionInputCtrl');
        var outputDiv = document.getElementById('output');
        var model = bindr.model({'expression': ''});

        bindr.bindElement(model, document.getElementById('in'), 'expression');
        bindr.bindElement(model, document.getElementById('out'), 'expression');

        expressionInputCtrl.bind(document.getElementById('in'), model);

        app.command('calculateExpression', function() {
            var expr = expression.parse(model.expression);

            if(expr == null) {
                alert('incorrect expression');
                return;
            }

            var view = new window.app.views.ExpressionView(expr);

            var result = document.createElement('div');
            result.innerHTML = view.getHtml();

            outputDiv.appendChild(result);

            model.expression = '';
        });

    })();

</script>

</body>
</html>